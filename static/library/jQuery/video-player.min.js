var languageList = captions = []; function OOCreate(a) { window.messageBus = a.mb; a.mb.subscribe(OO.EVENTS.FULLSCREEN_CHANGED, "UITeam", function () { if ($(".oo_fullscreen").hasClass("oo_fullscreen_off")) { $(".wrapper").css({ width: "100%", height: "100%" }); $(".round-corners").css("overflow", "visible"); $("#ooyalaplayer .plugins").hide(); disableHoverToggle($("#ooyalaplayer .plugins")) } else { if ($(".oo_fullscreen").hasClass("oo_fullscreen_on")) { $(".wrapper").css("width", "967px"); $(".round-corners").css("overflow", "hidden"); enableHoverToggle($("#ooyalaplayer .plugins")) } } }); a.mb.subscribe(OO.EVENTS.INITIAL_PLAY, "UITeam", function () { jQuery.ajax({ url: "/sso/VideoIDSet", data: { videoid: ooyala_player_handle.currentItem.embed_code }, contentType: "application/json; charset=utf-8" }) }); a.mb.subscribe(OO.EVENTS.PLAYBACK_READY, "UITeam", function () { var b = $(".plugins"), d = "", c; d = ooyala_player_handle.currentItem.title; addPlayerControls(); $(b).css("display", "").append('<div id="player-toolbar"><p>' + d + '</p><ul><li id="info"><span></span></li><li id="email"><span></span></li><li id="share"><span></span></li><li id="embed"><span></span></li></ul></div>'); c = $("#ooyalaplayer .plugins"); enableHoverToggle(c); c.show().delay(1000).fadeOut(); $("#player-toolbar > p").dotdotdot({ height: 20 }); $("#ooyalaplayer .plugins #player-toolbar ul li").click(function () { disableHoverToggle(c); var g = $(this).attr("id"), e = $('<div id="overlay"><div></div></div>'), f = ooyala_player_handle.currentItem; $(" #player-toolbar >p").hide(); $("#player-toolbar ul li span").removeClass("active"); ooyala_player_handle.pause(); if ($("#overlay").length == 0) { e.appendTo($("#ooyalaplayer .innerWrapper")) } $("#ooyalaplayer .oo_promo div.oo_start_button").hide(); $("#player-toolbar ul").show(); $("#ooyalaplayer .plugins").removeClass("show").show().css("background", "none"); $("#overlay > div").empty(); $("#player-toolbar").find("#" + g + " span").addClass("active"); appendOverlayContent(g, f) }); $("body").on("click", "#oo-toolbar a", function (j) { var h = $(this).parent(), i = h.attr("class"), f = "", g = $("h1").text().trim() + " | Dell Software"; if (h.hasClass("facebook")) { if (typeof s == "object") { s.events = "event13"; s.eVar18 = "Facebook"; s.linkTrackVars = "events,eVar18"; s.linkTrackEvents = "event13"; s.tl(true, "o", "Social Media") } j.preventDefault(); window.open("http://www.facebook.com/sharer.php?u=" + encodeURIComponent(burl) + "&t=" + encodeURIComponent(g), "facebook", "width=480,height=240,toolbar=0,status=0,resizable=1") } else { if (h.hasClass("twitter")) { if (typeof s == "object") { s.events = "event13"; s.eVar18 = "Twitter"; s.linkTrackVars = "events,eVar18"; s.linkTrackEvents = "event13"; s.tl(true, "o", "Social Media") } j.preventDefault(); window.open("http://twitter.com/share?via=DellSoftware&url=" + encodeURIComponent(burl) + "&text=" + encodeURIComponent(g) + ",%20&counturl=" + encodeURIComponent(f), "twitter", "width=480,height=380,toolbar=0,status=0,resizable=1") } else { if (h.hasClass("linkedin")) { if (typeof s == "object") { s.events = "event13"; s.eVar18 = "LinkedIn"; s.linkTrackVars = "events,eVar18"; s.linkTrackEvents = "event13"; s.tl(true, "o", "Social Media") } j.preventDefault(); window.open("http://www.linkedin.com/shareArticle?mini=true&url=" + encodeURIComponent(burl) + "&title=" + encodeURIComponent(g), "linkedin", "width=480,height=360,toolbar=0,status=0,resizable=1") } } } }); processClosedCaption() }) } function processClosedCaption() { var a = "ooyalaplayer", d = ooyala_player_handle.currentItem.closed_captions[0].url, c = "en", b = "us"; jQuery.ajax({ url: d, type: "GET", dataType: "xml" }).done(function (f) { captionsXml = $(f); allCaptions = createCaptionsCollection(captionsXml.find("div")); if (allCaptions.length > 0) { var e = $("#" + a); e.find(".oo_controls").append('				<div id="captionsContainer">					<div id="captionBackground">						&nbsp;					</div>					<div id="caption">					</div>				</div>				'); addCCButton(a); captions = findCurrentCC(c, b); if (captions.length == 0) { captions = findCurrentCC(c) } if ($("#off-caption").hasClass("disabled")) { onCaptions() } $(".oo_controls").addClass("has-cc") } window.messageBus.subscribe(OO.EVENTS.PLAYHEAD_TIME_CHANGED, "UITeam", function (g, i, h) { onPlayheadTimeChanged(i) }) }).fail(function (e) { console.log("Did not get closed captions") }) } function getTime(c) { var c = c.split(":"); var a = parseInt(c[0], 10); var b = parseInt(c[1], 10); var d = parseInt(c[2], 10); return ((a * 3600) + (b * 60) + d) } function onPlayheadTimeChanged(d) { var c = d; var a; for (var b in captions) { var b = captions[b]; if (c > b.begin) { if (c <= b.end) { a = b } } else { if (a) { break } } } if (a && (a != "")) { $("#captionsContainer").css("opacity", "1"); $("#caption")[0].innerHTML = a.text; if (a.text.replace(" ", "") == "") { $("#captionsContainer").css("opacity", "0") } } else { $("#captionsContainer").css("opacity", "0") } if (lastCaption != a) { $("#captionsContainer").css("width", "100%"); if (a != "") { resizeCaptions() } } lastCaption = a } function changeCC(b) { if ($(this).hasClass("ccLanguage-disabled") == false) { var a = b.target.attributes.data.nodeValue; captions = findCurrentCC(a); $("#ccLanguageModal").trigger("reveal:close"); $("#videoLanguage01").hide(); $("#cc_icon").attr("lanHidden", "true") } window.messageBus.publish(OO.EVENTS.PLAY) } function offCaptions() { $("#off-caption").removeClass("disabled"); $("#on-caption").addClass("disabled"); $("#captionsContainer").hide(); $("#listLanguages").hide(); $(".ccLanguage").addClass("ccLanguage-disabled"); $("#videoLanguage01").hide(); $("#cc_icon").attr("lanHidden", "true"); window.messageBus.publish(OO.EVENTS.PLAY) } function onCaptions() { $("#on-caption").removeClass("disabled"); $("#off-caption").addClass("disabled"); $("#captionsContainer").show(); $("#listLanguages").show(); $(".ccLanguage").removeClass("ccLanguage-disabled") } function createCaptionsCollection(f) { numCCLanguages = f.length; var a = []; var k = "xx"; var c = ""; if (numCCLanguages > 0) { $("body").append('								<div id="ccLanguageModal" style="display:none;">										<p style="margin-bottom:10px;">Captions : 												<a id="on-caption" href="javascript:void(0);" class="ooyala-caption" onClick="onCaptions();">On</a>												<a id="off-caption" href="javascript:void(0);" class="disabled ooyala-caption" onClick="offCaptions();">Off</a>										</p>										<ul id="listLanguages"></ul>								</div>') } for (var g = 0; g < numCCLanguages; g++) { var b = $(f[g]); var h = b.attr("xml:lang"); var e = mapLanguageCodes(h); languageList.push(h); $("#listLanguages").append('<li class="ccLanguage" data="' + h + '" >' + e + "</li>"); var l = []; var j = b.find("p"); for (var i = 0; i < j.length; i++) { c = h; if (c != k) { l.push({ begin: getTime($(j[i]).attr("begin")), end: getTime($(j[i]).attr("end")), text: $(j[i]).text() }) } } k = c; a.push(l) } $(".ccLanguage").bind("click", this, changeCC); return a } function ccButtonHandler() { if (jQuery.trim($(this).attr("lanHidden")) == "true") { $("#videoLanguage01").show(); $("#cc_icon").attr("lanHidden", "false"); window.messageBus.publish(OO.EVENTS.PAUSE) } else { $("#videoLanguage01").hide(); $("#cc_icon").attr("lanHidden", "true"); window.messageBus.publish(OO.EVENTS.PLAY) } } function findCurrentCC(d, a) { for (var c = 0; c < languageList.length; c++) { var e = languageList[c].toLowerCase(); var b = (a != undefined) ? (d + "-" + a) : d; if (b.toLowerCase() == "zh-cn") { b = "zh-hans" } else { if (b.toLowerCase() == "zh-tw") { b = "zh-hant" } } if (e.toLowerCase() == b.toLowerCase()) { return allCaptions[c] } } return [] } function mapLanguageCodes(a) { switch (a.toLowerCase()) { case "da": return "Dansk"; case "de": return "Deutsch"; case "en": return "English"; case "en-us": return "English (US)"; case "en-uk": return "English (UK)"; case "es": return "Espa�ol"; case "fr": return "Fran�ais"; case "hi": return "&#2361;&#2367;&#2344;&#2381;&#2342;&#2368;"; case "it": return "Italiano"; case "ja": return "&#26085;&#26412;&#35486;"; case "ko": return "&#51312;&#49440;&#47568;, &#54620;&#44397;&#50612;"; case "nl": return "Nederlands"; case "pt": case "pt-pt": return "Portugu�s"; case "pt-br": return "Portugu�s (Brasil)"; case "zh-hans": return "&#31616;&#20307;&#20013;&#25991;"; case "zh-hant": return "&#32321;&#39636;&#20013;&#25991;"; case "ar": return "Arabic"; case "cs": return "Czech"; case "el": return "Greek"; case "fi": return "Finnish"; case "fr-ca": return "Fran�ais (Canada)"; case "he": return "Hebrew"; case "hu": return "Hungarian"; case "no": return "Norweigan"; case "pl": return "Polish"; case "ro": return "Romanian"; case "ru": return "Russian"; case "sv": return "Swedish"; case "tr": return "Turkish" } } function addCCButton(b) { $("#" + b).find(".vod").append('<div id="cc_icon" class="oo_button oo_toolbar_item oo_cc" lanHidden="true"></div>'); $("#cc_icon").bind("click", "", ccButtonHandler); var d = b; var e = $("#" + d); var c = e.find(".vod"); e.find(".oo_controls").attr("cc", "cc"); var a = '<div id="videoLanguage01"></div>'; $(c).append(a); $("#videoLanguage01").append($("#ccLanguageModal")); $("#ccLanguageModal").show(); $("#videoLanguage01").hide(); $("#cc_icon").attr("lanHidden", "true") } function appendOverlayContent(b, a) { if ($("#overlay > div").is(":empty")) { $("#overlay > div").append('<div class="info"><p>' + a.title + "</p><p>" + a.description + '</p><a href="javascript:void(0)" onclick="removeOverlay()">Close</a></div><div class="email"><h2>Email to a friend</h2><form id="sendemail"><label>Email to</label><span class="required">*</span><input id="emailfield" type="text" size="37"/><label>Message</label><textarea rows="3" cols="35"></textarea><input type="button" value="Send" id="sendbutton" class="button blue" onclick="validateForm()"/><a href="javascript:void(0)" onclick="removeOverlay()">Close</a></form><p id="errormessage">Please enter correct email addresses.<p></div><div class="share"><h2>Share this video</h2><div id="sharebuttons"><p>Share via social media</p><ul id="oo-toolbar"><li class="googleplusone"><div class="g-plusone" data-size="medium" data-annotation="none" data-callback="googlePlusOneCallback"></div></li><li class="twitter"><a href="#"><span class="icon twitter"></span></a></li><li class="linkedin"><a href="#"><span class="icon linkedin"></span></a></li><li class="facebook"><a href="#"><span class="icon facebook"></span></a></li></ul><label>Copy and paste this url to share</label><input type="text" size="37"></div><a href="javascript:void(0)" class="cancelbtn" onclick="removeOverlay()">Close</a></div><div class="embed"><h2>Add to website or blog</h2><label>Embed code</label><textarea rows="5" cols="35"><script height="384px" width="570px" src="http://player.ooyala.com/iframe.js#pbid=9eba220ad98c47cda9fdf6ba82ce607a&ec=' + ooyala_player_handle.currentItem.embed_code + '"><\/script></textarea><a href="javascript:void(0)" class="cancelbtn" onclick="removeOverlay()">Close</a></div>') } (function () { var c = document.createElement("script"); c.type = "text/javascript"; c.async = true; c.src = "//apis.google.com/js/plusone.js"; var d = document.getElementsByTagName("script")[0]; d.parentNode.insertBefore(c, d) })(); $("#sharebuttons input").val(burl); $("#overlay > div > div").each(function () { if (!$(this).hasClass(b)) { $(this).hide() } }); $("#overlay > div ." + b).show() } function enableHoverToggle(a) { $("#ooyalaplayer").on({ mouseover: function () { a.addClass("show"); if ($("#ooyalaplayer .plugins").hasClass("show")) { $("#player-toolbar > p").show() } }, mouseout: function () { a.removeClass("show") } }) } function disableHoverToggle(a) { $("#ooyalaplayer").off("mouseover mouseout"); a.removeClass("show") } function removeOverlay() { $("#overlay").remove(); enableHoverToggle($("#ooyalaplayer .plugins")); $("#player-toolbar ul li span").removeClass("active"); $("#ooyalaplayer .oo_promo div.oo_start_button").show(); $("#ooyalaplayer .plugins").removeAttr("style") } function validateForm() { var c = true, d = "", b = $("#sendemail #emailfield"), a = ""; if (b.attr("type") != "button") { d = (b.val() == undefined) ? "" : b.val(); if (!d.match(/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/)) { c = false; b.css("border-color", "#fd5400") } else { c = true } } if (!c) { $("#overlay > div p").show() } else { $("#overlay > div p").hide(); b.css("border-color", "#ccc"); a = $("#sendemail textarea").val() + "\n\n" + location.href; window.location.href = "mailto:" + $("#sendemail input").val() + "?subject=" + ooyala_player_handle.currentItem.title + " - (video)&body=" + encodeURIComponent(a) } } function addPlayerControls() { var a = '<div class="volume-wrapper"><div class="oo_toolbar_item oo_button oo_volume oo_volume_high oo_customUI"><div class="volume_slider"><input type="range" min="0" max="100" value="100"></div></div></div>'; $(a).insertBefore($(".oo_pause")[0]); $("#ooyalaplayer").on("mouseenter", ".volume-wrapper", function () { $(".volume_slider").show(); $(".oo_controls .oo_pause,.oo_play").animate({ left: 80 }, 500); $(".oo_full_controls .vod .oo_scrubber").animate({ left: 120 }, 500); $(".volume-wrapper").css({ width: 100 }) }).on("mouseleave", ".volume-wrapper", function () { $(".volume_slider").hide(); $(".oo_controls .oo_pause, .oo_play").animate({ left: 30 }, 500); $(".oo_full_controls .vod .oo_scrubber").animate({ left: 75 }, 500); $(".volume-wrapper").css({ width: 25 }) }).find(".oo_volume input").on("change", function () { var b = $(this).val() / 100; ooyala_player_handle.setVolume($(this).val() / 100) }) };