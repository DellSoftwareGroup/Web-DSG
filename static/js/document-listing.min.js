var populateListingPending=false,entriesPerType={0:6,1:12,2:16,3:16},endPointURL=((RootPath=="/"?"":RootPath)+"/jsonreq/document/").replace("//","/"),page=1,rowContainer=$(".listing-entries").find(".row");if($.fn.multipleSelect){init()}else{if($("html").hasClass("ie8")){$("<link/>",{rel:"stylesheet",href:"/static/library/css/multiple-select.css"}).appendTo("head")}$.getScript("/static/library/jQuery/jquery.multiple.select.js",function(){$.fn.multipleSelect.defaults.onOpen=function(elem){var nextElem=$(elem).next(),ul=nextElem.find("ul");if(ul.outerHeight()<ul.prop("scrollHeight")&&!ul.data("width-fixed")){ul.css("width",ul.outerWidth()+$.position.scrollbarWidth());ul.data("width-fixed",true)}nextElem.css("right","auto");if(nextElem.offset().left+nextElem.find("ul").outerWidth(true)>$("body").width()){nextElem.css("right",0)}else{nextElem.css("right","auto")}};init()})}if(typeof RootPath=="undefined"){RootPath="/"}function init(){var ajaxArr=[],filterMap=[{targetID:"country",data:{type:"document country"},init:true,callback:function(title){$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true,onClick:function(view){if(view.value!=""){populateDropdowns(filterMap[7].targetID,$.extend({},filterMap[7].data,{country:view.value}),filterMap[7].callback).done(function(){$("#state_province").next().removeClass("hidden")})}}});$(this).multipleSelect("uncheckAll")}},{targetID:"content_type",data:{type:"document type"},init:true,callback:function(title){$(this).prev().text(getLocalizedContent("DocumentLabelContentType"));$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("DocumentLabelContentType"),minimumCountSelected:0,countSelected:getLocalizedContent("DocumentLabelContentType")+"&nbsp;(#)",selectAllText:getLocalizedContent("LabelAllEventsSelected"),allSelected:getLocalizedContent("LabelSelectAllEvents"),onClose:function(){if(!$("#content_type").multipleSelect("getSelects").length){$("#content_type").multipleSelect("setSelects",[1])}else{caseStudyFilter()}}});$(this).multipleSelect("checkAll")}},{targetID:"brand",data:{type:"document product line"},init:true,callback:function(title){$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true,onClick:function(view){var obj={brand:view.value};$.each([4,5],function(i,j){ajaxArr.push(populateDropdowns(filterMap[j].targetID,$.extend({},filterMap[j].data,obj),filterMap[j].callback))})}});$(this).multipleSelect("uncheckAll")}},{targetID:"product",data:{type:"document product"},init:true,callback:function(title,prevValue){if(this.data("multipleSelect")){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[prevValue])}else{$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true,onClick:function(view){if(view.value!=""){$("#solution").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},{targetID:"solution",data:{type:"document solution"},init:true,callback:function(title,prevValue){if($(this).data("multipleSelect")){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[prevValue])}else{$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true,onClick:function(view){if(view.value!=""){$("#product").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},{targetID:"language",data:{type:"document language"},init:true,callback:function(title){$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true});$(this).multipleSelect("setSelects",[getLanguageCode()])}},{targetID:"industry",data:{type:"document industry"},init:true,callback:function(title){if(this.data("multipleSelect")){$(this).next().find("ul").remove();$(this).multipleSelect("refresh")}else{$(this).prev().text(title);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:title,multiple:false,selectAll:false,single:true});$(this).multipleSelect("uncheckAll")}}}];$(document).ready(function(){var filterInterval=null;getLocalizedContent(["DocumentLabelContentType","LabelAllEventsSelected","LabelSelectAllEvents","DocumentLabelUpdated"]).done(function(){$.each(filterMap,function(i,entry){if(entry.init){ajaxArr.push(populateDropdowns(entry.targetID,entry.data,entry.callback))}});$.when.apply(this,ajaxArr).done(function(){if(location.hash.length){parseHashTag()}$(".filters").on("change","select",function(){if(filterInterval===null){filterInterval=setInterval(function(){clearInterval(filterInterval);setTimeout(function(){filterInterval=null},100);if(ajaxArr.length){$.when(ajaxArr).done(function(){populateListing();ajaxArr=[]})}else{populateListing()}},100)}});ajaxArr=[];populateListing()}).fail(function(){alert("Failed")})});$("body").on("click",".resetfilter",function(e){e.preventDefault();if($(".filters").hasClass("disabled")){return false}location.hash="";$("select").multipleSelect("uncheckAll");$("#content_type").multipleSelect("checkAll");$("#language").multipleSelect("setSelects",[getLanguageCode()]);location.hash=""});$("#view-more").on("click",function(e){e.preventDefault();var top=$("html").scrollTop();populateListing(false).done(function(){$("html").scrollTop(top)})})});function parseHashTag(){var hash=location.hash.substr(1),hashArr=hash.split("_"),map={content_type:"",brand:"bybrand",product:"byproduct",solution:"bysolution",language:"bylang"},hashObj={};$.each(map,function(filterName,filterMapTo){var regexp=new RegExp("^"+filterMapTo,"i");if(hashObj[filterMapTo]){setFilterValue($("#"+filterName),hashObj[filterMapTo]);return false}else{$.each(hashArr,function(indx,name){if(regexp.test(name)){var elem=$("#"+filterName),selectFilterValue=name.replace(regexp,"");if(filterName!="content_type"){hashObj[filterMapTo]=selectFilterValue}setFilterValue(elem,selectFilterValue);return false}})}});caseStudyFilter();function setFilterValue(elem,val){if(elem.multipleSelect("getSelects")!=elem.val()){elem.find("option").each(function(){if($(this).text().replace(/[\s\W]/g,"").toLowerCase()==val){elem.multipleSelect("setSelects",[$(this).val()]);return false}})}}}function populateDropdowns(dropdown,data,callback){var elem=$("#"+dropdown),prevValue=elem.val();elem.empty();return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:data}).done(function(dataopt){if(dataopt.title){elem.append('<option value="">'+dataopt.title+"</option>")}$.each(dataopt.data,function(key,val){elem.append('<option value="'+val.id+'">'+val.value+"</option>")});if(typeof callback=="function"){callback.call(elem,dataopt.title,prevValue)}})}}addResize(function(){populateListing(true)});function populateListing(clear){if(typeof clear=="undefined"){clear=true}if(populateListingPending){return false}buildAHashTag();var dataset=getDataSet(!clear);if(dataset===false){return false}populateListingPending=true;return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:dataset,beforeSend:function(){$("#ui-loader").show()}}).done(function(dataopt){populateListingPending=false;$("#ui-loader").hide();if(clear){rowContainer.empty()}$.each(dataopt.data,function(key,val){var htmlFragment='<div class="col-md-3 col-sm-4 col-xs-12" style="display: none;"> '+'<a href="'+val.url+'">'+'  <div class="border-grey img-crop">'+'    <img class="img-responsive center-block" src="'+val.imageurl+'" alt=""> '+"  </div> "+'  <h4 class="text-blue">'+val.title+" </h4> ";if(val.description!=null){htmlFragment+='<p class="teaser"> '+val.description+" </p>"}if(val.date!=""){htmlFragment+="<p>"+getLocalizedContent("DocumentLabelUpdated")+": "+val.date+"</p>"}htmlFragment+="</a></div>";rowContainer.append(htmlFragment);if(pageType>=2&&(key+1)%4==0&&key!=0||pageType==1&&(key+1)%3==0&&key!=0){rowContainer.append('<div class="clearfix">')}});var viewMoreButton=$("#view-more");if(dataopt.total){$("#no-results").addClass("hidden");if(dataopt.total>entriesPerType[pageType]*page){viewMoreButton.removeClass("hidden")}else{viewMoreButton.addClass("hidden")}}else{$("#no-results").removeClass("hidden");viewMoreButton.addClass("hidden")}$(".total_results").html(dataopt.total);setTimeout(function(){rowContainer.find("> div").filter(":not(:visible)").show().css("opacity",0).animate({opacity:1},500)},100)})}function buildAHashTag(){var hashArr=[],map={content_type:"",product:"byproduct",solution:"bysolution",productline:"byproductline",brand:"bybrand",language:"bylang"};$.each(map,function(id,prefix){var elem=$("#"+id),val=elem.multipleSelect("getSelects");if(id=="content_type"){if(val.length==1){hashArr.push($.trim(elem.multipleSelect("getSelects","text")).toLowerCase().replace(/[\s\W]/g,""))}}else{if(id=="language"){if(parseInt(elem.val())==getLanguageCode()){return true}}var filterValue=$.trim(elem.multipleSelect("getSelects","text")[0]).toLowerCase().replace(/[\s\W]/g,"");if(filterValue!=""){hashArr.push(prefix+filterValue)}}});var newHash=hashArr.join("_");location.hash=newHash==""?" ":newHash}function getLanguageCode(){if(typeof RootPath=="string"){switch(RootPath){case"/br-pt/":initlangval=139;break;case"/mx-es/":initlangval=156;break;case"/cn-zh/":initlangval=202;break;case"/jp-ja/":initlangval=109;break;case"/fr-fr/":initlangval=75;break;case"/de-de/":initlangval=86;break;default:initlangval=53;break}if(location.host=="stage-software-dell-com"){switch(RootPath){case"/br-pt/":initlangval=139;break;case"/mx-es/":initlangval=156;break;case"/cn-zh/":initlangval=202;break;case"/jp-ja/":initlangval=109;break;case"/fr-fr/":initlangval=75;break;case"/de-de/":initlangval=86;break;default:initlangval=53;break}}}return initlangval}function getDataSet(incrementPage){var dataset={type:"document list",page:incrementPage?++page:1,pagesize:entriesPerType[pageType]},mapping={documenttypes:"content_type",product:"product",solution:"solution",brand:"brand",language:"language",country:"country",state:"state_province"},hasError=false;$.each(mapping,function(key,id){var val=$("#"+id).val();if(id=="content_type"){if(val===null){hasError=true;return false}dataset[key]=val.join(",")}else{dataset[key]=val}});return hasError?false:dataset}function caseStudyFilter(){if($.inArray("167",$("#content_type").multipleSelect("getSelects"))>-1){$("#country").parent().show();$("#industry").parent().show()}else{$("#country").parent().hide();$("#industry").parent().hide()}}