if(typeof RootPath=="undefined"){RootPath="/"}var populateListingPending=false,entriesPerType={0:6,1:12,2:16,3:16},endPointURL=((RootPath=="/"?"":RootPath)+"/jsonreq/video/").replace("//","/"),page=1,rowContainer=$(".listing-entries").find(".row"),hashMap={video_type:"",product:"byproduct",solution:"bysolution",brand:"byproductline"};if($.fn.multipleSelect){init()}else{if($("html").hasClass("ie8")){$("<link/>",{rel:"stylesheet",href:"/static/library/css/multiple-select.css"}).appendTo("head")}$.getScript("/static/library/jQuery/jquery.multiple.select.js",function(){$.fn.multipleSelect.defaults.onOpen=function(elem){var nextElem=$(elem).next(),ul=nextElem.find("ul");if(ul.outerHeight()<ul.prop("scrollHeight")&&!ul.data("width-fixed")){ul.css("width",ul.outerWidth()+$.position.scrollbarWidth());ul.data("width-fixed",true)}nextElem.css("right","auto");if(nextElem.offset().left+nextElem.find("ul").outerWidth(true)>$("body").width()){nextElem.css("right",0)}else{nextElem.css("right","auto")}};init()})}function init(){var ajaxArr=[],filterMap={solution:{data:{type:"video solution"},init:true,callback:function(title,prevValue){if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[prevValue])}else{$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("LabelAllSolutions"),multiple:false,selectAll:false,single:true,onClick:function(view){if(view.value!=""){$("#product").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},brand:{data:{type:"video product line"},init:true,callback:function(title){$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("LabelAllProductLines"),multiple:false,selectAll:false,single:true,onClick:function(view){var obj={brand:view.value};$.each(["product","solution"],function(i,j){ajaxArr.push(populateDropdowns(j,$.extend({},filterMap[j].data,obj),filterMap[j].callback))})}});$(this).multipleSelect("uncheckAll")}},product:{data:{type:"video product"},init:true,callback:function(title,prevValue){if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[prevValue])}else{$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("LabelAllProducts"),multiple:false,selectAll:false,single:true,onClick:function(view){if(view.value!=""){$("#solution").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},video_type:{data:{type:"video type"},init:true,callback:function(title,prevValue){if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[prevValue])}else{$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("LabelVideoTypes"),minimumCountSelected:0,countSelected:getLocalizedContent("LabelVideoTypes")+"&nbsp;(#)",selectAllText:getLocalizedContent("LabelAllVideoTypes"),allSelected:getLocalizedContent("LabelAllVideoTypes"),onClose:function(){if(!$("#video_type").multipleSelect("getSelects").length){$("#video_type").multipleSelect("setSelects",[$("#video_type").find("option:eq(0)").attr("value")])}}});$(this).multipleSelect("checkAll")}}}};$(document).ready(function(){var filterInterval=null,filterElem=$(".filters");getLocalizedContent(["EventLabelDuration","LabelAllProducts","LabelAllProductLines","LabelAllSolutions","LabelVideoTypes","LabelAllVideoTypes"]).done(function(){$.each(filterMap,function(id,entry){if(entry.init){ajaxArr.push(populateDropdowns(id,entry.data,entry.callback))}});$.when.apply(this,ajaxArr).done(function(){if(location.hash.length){location.hash=location.hash.replace("bybrand","byproductline");parseHashTag()}filterElem.data("continue",true).on("change","select",function(){if(filterElem.data("continue")&&filterInterval===null){filterInterval=setInterval(function(){clearInterval(filterInterval);setTimeout(function(){filterInterval=null},100);if(ajaxArr.length){$.when(ajaxArr).done(function(){populateListing();ajaxArr=[]})}else{populateListing()}},100)}setFilterNum()});ajaxArr=[];setFilterNum();populateListing()}).fail(function(){console.log("Failed")})});$("body").on("click",".resetfilter",function(e){e.preventDefault();filterElem.data("continue",false);filterElem.find("select").each(function(){if($(this).next().is(":visible")){if($(this).attr("id")=="video_type"){$(this).multipleSelect("checkAll")}else{$(this).multipleSelect("uncheckAll")}}});$.each(["product","solution"],function(i,j){ajaxArr.push(populateDropdowns(j,filterMap[j].data,filterMap[j].callback))});$.when(ajaxArr).done(function(){ajaxArr=[];filterElem.data("continue",true);populateListing(true)})});$("#view-more").on("click",function(e){e.preventDefault();$(this).addClass("hidden");var top=window.scrollY||$("html").scrollTop();populateListing(false).done(function(){window.scrollTo(0,top)});window.scrollTo(0,top)})});function parseHashTag(){var hash=location.hash.substr(1),hashArr=hash.split("_");$.each(hashMap,function(filterName,filterMapTo){var regexp=new RegExp("^"+filterMapTo,"i");$.each(hashArr,function(indx,name){if(regexp.test(name)){var elem=$("#"+filterName),selectFilterValue=name.replace(regexp,"");setFilterValue(elem,selectFilterValue);return false}})});function setFilterValue(elem,val){if(elem.multipleSelect("getSelects")!=elem.val()){var value="";elem.find("option").each(function(){if($(this).text().replace(/[\s\W]/g,"").toLowerCase()==val){elem.multipleSelect("setSelects",[$(this).val()]);value=$(this).val();return false}});if(elem.attr("id")=="brand"&&value!=""){$.each(["product","solution"],function(i,j){populateDropdowns(j,$.extend({},filterMap[j].data,{brand:value}),filterMap[j].callback)})}}}}function populateDropdowns(dropdown,data,callback){var elem=$("#"+dropdown),prevValue=elem.val();elem.empty();return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:data}).done(function(dataopt){if(dropdown=="solution"){elem.append('<option value="">'+getLocalizedContent("LabelAllSolutions")+"</option>")}else if(dropdown=="brand"){elem.append('<option value="">'+getLocalizedContent("LabelAllProductLines")+"</option>")}else if(dropdown=="product"){elem.append('<option value="">'+getLocalizedContent("LabelAllProducts")+"</option>")}$.each(dataopt.data,function(key,val){if(val.englishname){elem.append('<option value="'+val.id+'" data-name="'+val.englishname+'">'+val.value+"</option>")}else if(val.englishvalue){elem.append('<option value="'+val.id+'" data-name="'+val.englishvalue+'">'+val.value+"</option>")}else{elem.append('<option value="'+val.id+'">'+val.value+"</option>")}});if(typeof callback=="function"){callback.call(elem,dataopt.title,prevValue)}})}}addResize(function(){populateListing(true);setFilterNum()});function populateListing(clear){if(typeof clear=="undefined"){clear=true}if(populateListingPending){return false}buildAHashTag();var dataset=getDataSet(!clear),viewMoreButton=$("#view-more");if(dataset===false){rowContainer.empty();$("#no-results").removeClass("hidden");viewMoreButton.addClass("hidden");return false}populateListingPending=true;return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:dataset,beforeSend:function(){$("#ui-loader").show()}}).done(function(dataopt){populateListingPending=false;$("#ui-loader").hide();if(clear){rowContainer.empty()}$.each(dataopt.data,function(key,val){var htmlFragment='<div class="col-md-3 col-sm-4 col-xs-12" style="display: none;"> '+'<a href="'+val.URL+'">'+'  <div class="img-border">'+'    <img class="img-responsive center-block" src="'+val.ImageURL2+'" alt="" onerror="this.style.display=\'none\';" /> '+'		 <div class="img-overlay vertical-center horizontal-center"><div><span class="icon-ui-play-underlay"></span><span class="icon-ui-play"></span></div></div>'+"  </div>"+'  <h4 class="text-blue dotdotdot" data-max-line="3">'+val.DisplayName+" </h4> ";if(val.Desc!=null){htmlFragment+='<p class="teaser dotdotdot" data-max-line="5"> '+val.Desc+" </p>"}if(val.Duration!=""){htmlFragment+="<p>"+getLocalizedContent("EventLabelDuration")+": "+val.Duration+"</p>"}htmlFragment+="</a>";htmlFragment+="</div>";rowContainer.append(htmlFragment);if(pageType>=2&&(key+1)%4==0&&key!=0||pageType==1&&(key+1)%3==0&&key!=0){rowContainer.append('<div class="clearfix">')}});setTimeout(function(){processFlex()},500);if(dataopt.total){$("#no-results").addClass("hidden");if(dataopt.total>entriesPerType[pageType]*page){viewMoreButton.removeClass("hidden")}else{viewMoreButton.addClass("hidden")}}else{$("#no-results").removeClass("hidden");viewMoreButton.addClass("hidden")}$(".total_results").html(dataopt.total);setTimeout(function(){rowContainer.find("> div").filter(":not(:visible)").show().css("opacity",0).animate({opacity:1},500,function(){processEllipsis(this)})},100)})}function buildAHashTag(){var hashArr=[],top=window.scrollY||$("html").scrollTop();$.each(hashMap,function(id,prefix){var elem=$("#"+id),val=elem.multipleSelect("getSelects");if(id=="video_type"){if(val.length==1){elem.find("option").each(function(){if($(this).attr("value")==val[0]){hashArr.push($.trim($(this).data("name")||$(this).text()).toLowerCase().replace(/[\s\W]/g,""));return false}})}}else{elem.find("option").each(function(){if($(this).attr("value")==val[0]){hashArr.push(prefix+$.trim($(this).data("name")||$(this).text()).toLowerCase().replace(/[\s\W]/g,""));return false}})}});if(hashArr.length){var newHash=hashArr.join("_");location.hash=newHash==""?" ":newHash}else{location.hash=" "}window.scrollTo(0,top)}function getLanguageCode(){var langval=53;if(typeof RootPath=="string"){switch(RootPath){case"/br-pt/":langval=139;break;case"/mx-es/":langval=156;break;case"/cn-zh/":langval=202;break;case"/jp-ja/":langval=109;break;case"/fr-fr/":langval=75;break;case"/de-de/":langval=86;break}}return langval}function getDataSet(incrementPage){page=incrementPage?++page:1;var dataset={type:"video list",page:page,pagesize:entriesPerType[pageType]},mapping={videoType:"video_type",product:"product",solution:"solution",brand:"brand"},hasError=false;$.each(mapping,function(key,id){var val=$("#"+id).val();if(id=="video_type"){if(val===null||val===undefined){hasError=true;return false}dataset[key]=val.join(",")}else{dataset[key]=val}});return hasError?false:dataset}function setFilterNum(){var counter=0;$(".filters").find("select").each(function(){if(($(this).is(":visible")||pageType==0)&&$(this).data("multipleSelect")!==undefined){var selects=$(this).multipleSelect("getSelects");if(selects.length==1){if(selects[0]!=""){counter++}}else{counter+=selects.length}}});$(".filter-num").text(counter)}