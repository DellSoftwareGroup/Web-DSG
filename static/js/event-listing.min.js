if(typeof RootPath=="undefined"){RootPath="/"}var populateListingPending=false,entriesPerType={"0":6,"1":12,"2":16,"3":16},endPointURL=(((RootPath=="/")?"":RootPath)+"/jsonreq/event/").replace("//","/"),page=1,rowContainer=$(".listing-entries").find(".row"),hashMap={event_type:"",product:"byproduct",solution:"bysolution",brand:"bybrand",language:"bylang"};if($.fn.multipleSelect){init()}else{if($("html").hasClass("ie8")){$("<link/>",{rel:"stylesheet",href:"/static/library/css/multiple-select.css"}).appendTo("head")}$.getScript("/static/library/jQuery/jquery.multiple.select.js",function(){$.fn.multipleSelect.defaults.onOpen=function(c){var a=$(c).next(),b=a.find("ul");if(b.outerHeight()<b.prop("scrollHeight")&&!b.data("width-fixed")){b.css("width",b.outerWidth()+$.position.scrollbarWidth());b.data("width-fixed",true)}a.css("right","auto");if(a.offset().left+a.find("ul").outerWidth(true)>$("body").width()){a.css("right",0)}else{a.css("right","auto")}};init()})}function init(){var b=[],e={country:{data:{type:"event country"},init:true,callback:function(f){$(this).prev().text(f);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:f,multiple:false,selectAll:false,single:true,onClick:function(g){if(g.value!=""){c("state_province",$.extend({},e.state_province.data,{country:g.value}),e.state_province.callback)}}});$(this).multipleSelect("uncheckAll")}},event_type:{data:{type:"event type"},init:true,callback:function(f){$(this).prev().text(getLocalizedContent("EventLabelEventType"));$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:getLocalizedContent("EventLabelEventType"),minimumCountSelected:0,countSelected:getLocalizedContent("EventLabelEventType")+"&nbsp;(#)",selectAllText:getLocalizedContent("LabelAllEvents"),allSelected:getLocalizedContent("LabelAllEvents"),onClose:function(){if(!$("#event_type").multipleSelect("getSelects").length){$("#event_type").multipleSelect("setSelects",[1])}}});$(this).multipleSelect("checkAll")}},event_date:{data:{type:"event dates"},init:true,callback:function(f){$(this).prev().text(getLocalizedContent("EventLabelDate"));$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:f,multiple:false,selectAll:false,single:true});$(this).multipleSelect("uncheckAll")}},brand:{data:{type:"event product line"},init:true,callback:function(f){$(this).prev().text(f);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:f,multiple:false,selectAll:false,single:true,onClick:function(g){var h={brand:g.value};$.each(["product","solution"],function(l,k){b.push(c(k,$.extend({},e[k].data,h),e[k].callback))})}});$(this).multipleSelect("uncheckAll")}},product:{data:{type:"event product"},init:true,callback:function(g,f){if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[f])}else{$(this).prev().text(g);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:g,multiple:false,selectAll:false,single:true,onClick:function(h){if(h.value!=""){$("#solution").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},solution:{data:{type:"event solution"},init:true,callback:function(g,f){if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh");$(this).multipleSelect("setSelects",[f])}else{$(this).prev().text(g);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:g,multiple:false,selectAll:false,single:true,onClick:function(h){if(h.value!=""){$("#product").multipleSelect("setSelects",[])}}});$(this).multipleSelect("uncheckAll")}}},language:{data:{type:"event language"},init:true,callback:function(f){$(this).prev().text(f);$(this).parent().removeClass("hidden");$(this).multipleSelect({placeholder:f,multiple:false,selectAll:false,single:true});$(this).multipleSelect("setSelects",[getLanguageCode()])}},state_province:{data:{type:"event state"},init:false,callback:function(f){if($(this).find("option").length>1){$(this).parent().removeClass("hidden").show().find(".ms-parent").removeClass("hidden").show();if(typeof $(this).data("multipleSelect")=="object"){$(this).next().find("ul").remove();$(this).multipleSelect("refresh")}else{$(this).prev().text(f);$(this).multipleSelect({placeholder:f,multiple:false,selectAll:false,single:true});$(this).multipleSelect("uncheckAll");$(this).next().removeClass("hidden")}}else{$(this).parent().hide()}}}},d={};$(document).ready(function(){var f=null,g=$(".filters");getLocalizedContent(["EventLabelEventType","EventLabelDate","LabelAllEvents","EventLabelRecordedDate","EventLabelLocation","EventLabelAllDates","LabelAllProducts","LabelAllProductLines","LabelAllSolutions","LabelAllLanguages","LabelAllCountries","LabelAllStates"]).done(function(){$.each(e,function(i,h){if(h.init){b.push(c(i,h.data,h.callback))}});d={event_date:getLocalizedContent("EventLabelAllDates"),product:getLocalizedContent("LabelAllProducts"),brand:getLocalizedContent("LabelAllProductLines"),solution:getLocalizedContent("LabelAllSolutions"),language:getLocalizedContent("LabelAllLanguages"),country:getLocalizedContent("LabelAllCountries"),state_province:getLocalizedContent("LabelAllStates")};$.when.apply(this,b).done(function(){if(location.hash.length){a()}g.data("continue",true).on("change","select",function(){if(g.data("continue")&&f===null){f=setInterval(function(){clearInterval(f);setTimeout(function(){f=null},100);if(b.length){$.when(b).done(function(){populateListing();b=[]})}else{populateListing()}},100)}setFilterNum()});b=[];setFilterNum();populateListing()}).fail(function(){console.log("Failed")})});$("body").on("click",".resetfilter",function(h){h.preventDefault();g.data("continue",false);g.find("select").each(function(){if($(this).next().is(":visible")){if($(this).attr("id")=="event_type"){$(this).multipleSelect("checkAll")}else{if($(this).attr("id")=="language"){$(this).multipleSelect("setSelects",[getLanguageCode()])}else{$(this).multipleSelect("uncheckAll");if($(this).attr("id")=="state_province"){$(this).parent().hide()}}}}});$.each(["product","solution"],function(l,k){b.push(c(k,e[k].data,e[k].callback))});$.when(b).done(function(){b=[];g.data("continue",true);populateListing(true)})});$("#view-more").on("click",function(i){i.preventDefault();$(this).addClass("hidden");var h=window.scrollY||$("html").scrollTop();populateListing(false).done(function(){window.scrollTo(0,h)});window.scrollTo(0,h)})});function a(){var h=location.hash.substr(1),f=h.split("_");$.each(hashMap,function(i,k){var j=new RegExp("^"+k,"i");$.each(f,function(n,l){if(j.test(l)){var m=$("#"+i),o=l.replace(j,"");g(m,o);return false}})});function g(j,l){if(j.multipleSelect("getSelects")!=j.val()||j.attr("id")=="language"){var k="";if(j.attr("id")=="language"&&l.length>1){var i=setLanguageCode(l);j.multipleSelect("setSelects",[i])}j.find("option").each(function(){if($(this).text().replace(/[\s\W]/g,"").toLowerCase()==l){j.multipleSelect("setSelects",[$(this).val()]);k=$(this).val();return false}});if(j.attr("id")=="brand"&&k!=""){$.each(["product","solution"],function(n,m){c(m,$.extend({},e[m].data,{brand:k}),e[m].callback)})}}}}function c(j,g,i){var f=$("#"+j),h=f.val();f.empty();return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:g}).done(function(k){if(j!="event_type"){k.title=d[j];f.append('<option value="">'+k.title+"</option>")}$.each(k.data,function(l,m){if(m.englishname){f.append('<option value="'+m.id+'" data-name="'+m.englishname+'">'+m.value+"</option>")}else{if(m.englishvalue){f.append('<option value="'+m.id+'" data-name="'+m.englishvalue+'">'+m.value+"</option>")}else{f.append('<option value="'+m.id+'">'+m.value+"</option>")}}});if(typeof i=="function"){i.call(f,k.title,h)}})}}addResize(function(){populateListing(true)});function populateListing(a){if(typeof a=="undefined"){a=true}if(populateListingPending){return false}buildAHashTag();var c=getDataSet(!a),b=$("#view-more");if(c===false){rowContainer.empty();$("#no-results").removeClass("hidden");b.addClass("hidden");return false}populateListingPending=true;return $.ajax({url:endPointURL,type:"POST",dataType:"JSON",data:c,beforeSend:function(){$("#ui-loader").show()}}).done(function(d){populateListingPending=false;$("#ui-loader").hide();if(a){rowContainer.empty()}$.each(d.data,function(e,g){if(g.typeid==1){event_bg="bg-green";event_img="online-event.jpg"}else{if(g.typeid==2){event_bg="bg-purple";event_img="in-person-event.jpg"}else{if(g.typeid==3){event_bg="bg-orange";event_img="webcast.jpg"}}}var f='<div class="col-md-3 col-sm-4 col-xs-12" style="display: none;"> <a href="'+g.url+'">  <div class="border-grey">    <p class="listing-header '+event_bg+' "> '+g.eventtype+' </p>    <img class="img-responsive" src="/images/shared/listing-entries/'+event_img+'" alt="">   </div>   <h4 class="text-blue dotdotdot" data-max-line="3">'+g.title+' </h4>   <p class="teaser dotdotdot" data-max-line="5"> '+$("<div>"+g.description+"</div>").text()+" </p>";if($.inArray(g.typeid,[1,2])>-1){f+='<p class="dates">'+getLocalizedContent("EventLabelDate")+": "+g.date+"</p>"}else{if(g.typeid==3){f+="<p>"+getLocalizedContent("EventLabelRecordedDate")+": "+g.recordeddate+"</p>"}}if(g.location){f+="<p>"+getLocalizedContent("EventLabelLocation")+": "+g.location+"</p>"}f+="</a></div>";rowContainer.append(f);if((pageType>=2&&((e+1)%4==0)&&e!=0)||(pageType==1&&((e+1)%3==0)&&e!=0)){rowContainer.append('<div class="clearfix">')}});if(d.total){$("#no-results").addClass("hidden");if(d.total>entriesPerType[pageType]*page){b.removeClass("hidden")}else{b.addClass("hidden")}}else{$("#no-results").removeClass("hidden");b.addClass("hidden")}$(".total_results").html(d.total);setTimeout(function(){rowContainer.find("> div").filter(":not(:visible)").show().css("opacity",0).animate({opacity:1},500,function(){processEllipsis(this)})},100)})}function buildAHashTag(){var a=[],c=window.scrollY||$("html").scrollTop();$.each(hashMap,function(g,e){var d=$("#"+g),f=d.multipleSelect("getSelects");if(g=="event_type"){if(f.length==1){d.find("option").each(function(){if($(this).attr("value")==f[0]){a.push($.trim($(this).data("name")||$(this).text()).toLowerCase().replace(/[\s\W]/g,""));return false}})}}else{if(g!="language"||(g=="language"&&parseInt(f[0])!=getLanguageCode())){d.find("option").each(function(){if($(this).attr("value")==f[0]){a.push(e+$.trim($(this).data("name")||$(this).text()).toLowerCase().replace(/[\s\W]/g,""));return false}})}}});if(a.length){var b=a.join("_");location.hash=(b=="")?" ":b}else{location.hash=" "}window.scrollTo(0,c)}function getLanguageCode(){var a=53;switch(RootPath){case"/br-pt/":a=139;break;case"/mx-es/":a=156;break;case"/cn-zh/":a=202;break;case"/jp-ja/":a=109;break;case"/fr-fr/":a=75;break;case"/de-de/":a=86;break}return a}function setLanguageCode(a){var b=53;switch(a){case"portuguese":b=139;break;case"spanish":b=156;break;case"chinese":b=202;break;case"japanese":b=109;break;case"french":b=75;break;case"german":b=86;break}return b}function getDataSet(c){page=c?++page:1;var d={type:"event list",page:page,pagesize:entriesPerType[pageType]},b={eventtypes:"event_type",daterange:"event_date",product:"product",solution:"solution",brand:"brand",language:"language",country:"country",state:"state_province"},a=false;$.each(b,function(e,g){var f=$("#"+g).val();if(g=="event_type"){if(f===null||f===undefined){a=true;return false}d[e]=f.join(",")}else{if(g=="event_date"){d[e]=(f===null||f===undefined)?"All":f}else{d[e]=f}}});return a?false:d}function setFilterNum(){var a=0;$(".filters").find("select").each(function(){if(($(this).is(":visible")||pageType==0)&&$(this).data("multipleSelect")!==undefined){var b=$(this).multipleSelect("getSelects");if(b.length==1){if(b[0]!=""){a++}}else{a+=b.length}}});$(".filter-num").text(a)};